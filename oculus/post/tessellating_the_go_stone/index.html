<!DOCTYPE html>
<html lang="en-us">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Tessellating The Go Stone | Gaffer On Games</title>

    
    <link href="http://127.0.0.1:1313/css/bootstrap.min.css" rel="stylesheet">

    
    <link href="http://127.0.0.1:1313/css/clean-blog.min.css" rel="stylesheet">

    
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    
    
    

</head>

<body>

    
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://127.0.0.1:1313">Gaffer On Games</a>
            </div>

                       
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    
                  </ul>
            </div>
           

        </div>
        
    </nav>


    
    
    <header class="intro-header" style="background-image: url('http://127.0.0.1:1313/img/post-bg.jpg')">
    
      <div class="container">
        <div class="row">
           <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
             <div class="post-heading">
               <h1>Tessellating The Go Stone</h1>
               <h2 class="subheading">Generating a triangle mesh for the go stone</h2>
               <span class="meta">Posted by <a href="http://127.0.0.1:1313/about">Glenn Fiedler</a> on Wednesday, February 20, 2013
               </span>
             </div>
           </div>
        </div>
      </div>
    </header>

    
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                  

<h2 id="introduction">Introduction</h2>

<p>Hi, I&rsquo;m Glenn Fiedler. Welcome to <a href="http://127.0.0.1:1313/categories/virtual-go/"><strong>Virtual Go</strong></a>, my project to create a physically accurate computer simulation of a Go board and stones.</p>

<p>In this article we want to draw the go stone using <a href="http://www.opengl.org">OpenGL</a>.</p>

<p>Unfortunately we can&rsquo;t just tell the graphics card, &ldquo;Hey! Please draw the intersection of two spheres with radius r and d apart with a bevel torus r<sub>1</sub> and r<sub>2</sub>!&ldquo;, because modern 3D graphics cards work by drawing triangles. We have to take our mathematical definition of the go stone and turn it into a set of triangles that the graphics card can render.</p>

<p>This is called tessellation and there are several different ways to do it.</p>

<h2 id="longitude-and-lattitude">Longitude And Lattitude</h2>

<p>The first way that I tried was to consider sphere rendering like a globe with longitude/latitude. I started with a ring around the &lsquo;equator&rsquo; of the go stone, stepping these rings up to the top of the sphere like the north pole on a globe.</p>

<p><img src="http://127.0.0.1:1313/img/virtualgo/naive-tesselation-side-view.gif" alt="naive tesselation side view" width="100%"/></p>

<p>Unfortunately, just like longitude/latitude on a globe, tessellating this way leads to very distorted mapping around the pole and a lot of wasted triangles:</p>

<p><img src="http://127.0.0.1:1313/img/virtualgo/inefficient-tesselation-at-pole.gif" alt="inefficient tesselation at pole" width="100%"/></p>

<h2 id="triangle-subdivision">Triangle Subdivision</h2>

<p>The next method is triangle subdivision. You start with an approximate shape then subdivide each triangle into four smaller triangles recursively like this:</p>

<p><img src="http://127.0.0.1:1313/img/virtualgo/sphere-tessellation.gif" alt="sphere tessellation" width="100%"/></p>

<p>Since the go stone only needs the top <sup>1</sup>&frasl;<sub>3</sub> or <sup>1</sup>&frasl;<sub>4</sub> of a sphere, I didn&rsquo;t want to subdivide a whole sphere only to throw most of it away. So I designed my own subdivision algorithm to generate only the top section of a sphere.</p>

<p>After some trial and error I found that a pentagon plus a center vertex at the pole of the sphere was a good initial generator that minimized the distortion that occurs during subdivision. The only tricky part is that when subdividing you need to keep track of whether the edge is a sphere edge or a circle edge, as the subdivided vertex must be projected differently.</p>

<p><img src="http://127.0.0.1:1313/img/virtualgo/generating-shape.gif" alt="generating shape" width="100%"/></p>

<p>With this technique I was able to generate a much more efficient tessellation:</p>

<p><img src="http://127.0.0.1:1313/img/virtualgo/regular-tessellation.gif" alt="regular tessellation" width="100%"/></p>

<h2 id="tessellating-the-bevel">Tessellating The Bevel</h2>

<p>Now we need to tesselate the bevel. To do this I take the vertices which form the circle edge at the bottom of the top sphere surface and calculate the angle of each vertex about the y axis. I then use these angles to sweep around the torus ensuring that the torus vertices weld perfectly with the top and bottom sphere sections.</p>

<p><img src="http://127.0.0.1:1313/img/virtualgo/go-stone-with-bevel.gif" alt="go stone with bevel" width="100%"/></p>

<h2 id="vertex-welding">Vertex Welding</h2>

<p>Due to how recursive subdivision works a lot of duplicate vertices are generated.</p>

<p>I&rsquo;d rather not have the graphics card waste time transforming the same vertex over and over, so as I add vertices to the mesh I hash vertex positions into a 3D grid (~1mm cells) and reuse an existing vertex if the position and normals match within some small epsilon value.</p>

<p>With vertex welding the reduction in vertices is dramatic: 53000 to just 6500.</p>

<p>For more information on vertex welding please refer to the discussion in <a href="http://www.amazon.com/Real-Time-Collision-Detection-Interactive-Technology/dp/1558607323/ref=sr_1_1?ie=UTF8&qid=1363029675&sr=8-1&keywords=real+time+collision+detection">Real-Time Collision Detection</a> by <a href="http://realtimecollisiondetection.net/blog/">Christer Ericson</a>.</p>

<p><strong>NEXT ARTICLE:</strong> <a href="http://127.0.0.1:1313/post/how_the_go_stone_moves/">How The Go Stone Moves</a></p>

                </div>
            </div>
        </div>
    </article>

    <hr>
    
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                  <ul class="list-inline text-center">
                    
                    <li>
                      <a href="https://www.linkedin.com/in/glennfiedler/">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                    <li>
                      <a href="https://twitter.com/gafferongames">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                    <li>
                      <a href="https://github.com/gafferongames">
                        <span class="fa-stack fa-lg">
                          <i class="fa fa-circle fa-stack-2x"></i>
                          <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                        </span>
                      </a>
                    </li>
                    
                  </ul>
                  <p class="copyright text-muted">Copyright Â© Glenn Fiedler, 2004 - 2018</p>
                </div>
            </div>
        </div>
    </footer>

    
    <script src="http://127.0.0.1:1313/js/jquery.min.js"></script>

    
    <script src="http://127.0.0.1:1313/js/bootstrap.min.js"></script>

    
    <script src="http://127.0.0.1:1313/js/clean-blog.js"></script>

    

</body>

</html>

